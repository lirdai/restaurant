(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{124:function(e,t,n){},147:function(e,t,n){"use strict";n.r(t);var r=n(7),c=n(40),a=n(0),s=n(1),i=n(36),o=n.n(i),l=n(12),d=n(18),u=n(4),j=n(3),b=n(95),O=n(50),p=n(19),h=n(102),m=n(98),x=n(33),v=(n(124),function(){return Object(a.jsxs)("div",{className:"footer",children:[Object(a.jsx)("div",{className:"footer-map",children:Object(a.jsx)("iframe",{title:"googleMap",frameBorder:"0",className:"map",src:"https://www.google.com/maps/embed/v1/place?key=".concat("AIzaSyCRRiBA9o4Pu36qmcy8tGMZOD4Ufmi7CWI","&q=").concat("290 Bremner Blvd, Toronto, ON"),allowFullScreen:!0})}),Object(a.jsxs)("div",{className:"footer-intro",children:[Object(a.jsx)("h3",{className:"pb-3",children:"Office Hours"}),Object(a.jsx)("p",{children:"Monday - Thursday: 7:00 a.m. ~ 3:00 p.m. "}),Object(a.jsx)("p",{className:"pb-5",children:"Friday - Sunday: 9:00 a.m. ~ 5:00 p.m. "}),Object(a.jsx)("p",{children:" \xa9 Created by Daisy Dai"}),Object(a.jsx)("p",{children:"Created on 11/18/2020"})]})]})}),g=n(9),f=n(150),y=n(151),S=function(e){for(var t=e.postsPerPage,n=e.totalPosts,r=e.Paginate,c=[],s=1;s<=Math.ceil(n/t);s++)c.push(s);return Object(a.jsx)("nav",{"aria-label":"Page navigation example",className:"pagination-nav",children:Object(a.jsx)("ul",{className:"pagination",children:c.map((function(e){return Object(a.jsx)("li",{className:"page-item",children:Object(a.jsx)("button",{onClick:function(){return r(e)},className:"page-link",children:e})},e)}))})})};function N(){var e=Object(g.a)(["\n  subscription {\n    reviewAdded {\n      user {\n        username\n      }\n      title\n      comment\n      date\n      id\n    }\n  }\n"]);return N=function(){return e},e}function $(){var e=Object(g.a)(["\nmutation addReview($user: ID!, $title: String!, $comment: String!) {\n  addReview(\n    user: $user,\n    title: $title,\n    comment: $comment\n  ) {\n    title\n    comment\n  }\n}\n"]);return $=function(){return e},e}function D(){var e=Object(g.a)(["\n  query {\n    findAllReviews{\n      id\n      title\n      comment\n      date\n      user {\n        username\n      }\n    }\n  }\n"]);return D=function(){return e},e}function w(){var e=Object(g.a)(["\n  query findSameKindFood($categoryToSearch: String!) {\n    findSameKindFood(category: $categoryToSearch) {\n      name\n      description\n      price\n      id\n    }\n  }\n"]);return w=function(){return e},e}var k=Object(u.gql)(w()),C=Object(u.gql)(D()),q=Object(u.gql)($()),I=Object(u.gql)(N());function M(e){return Object(a.jsx)("div",{children:Object(a.jsx)(f.a,{show:e.show,onHide:e.handleClose,children:Object(a.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n=e.userID,r=t.target.title.value,c=t.target.comment.value;e.addReview({variables:{user:n,title:r,comment:c}})},children:[Object(a.jsx)(f.a.Header,{closeButton:!0,children:Object(a.jsx)(f.a.Title,{children:"Edit Comment"})}),Object(a.jsxs)(f.a.Body,{children:[Object(a.jsx)("input",{type:"text",name:"title",placeholder:"Title"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("textarea",{rows:"5",cols:"60",name:"comment",placeholder:"Any Comment Here..."})]}),Object(a.jsxs)(f.a.Footer,{children:[Object(a.jsx)(y.a,{variant:"secondary",onClick:e.handleClose,type:"button",children:"Close"}),Object(a.jsx)(y.a,{variant:"primary",onClick:e.handleClose,type:"submit",children:"Save Comment"})]})]})})})}var E=function(e){var t=Object(s.useState)(!1),n=Object(r.a)(t,2),c=n[0],i=n[1],o=Object(s.useState)(null),d=Object(r.a)(o,2),j=d[0],b=d[1],O=Object(s.useState)([]),p=Object(r.a)(O,2),h=p[0],m=p[1],x=Object(s.useState)(1),v=Object(r.a)(x,2),g=v[0],f=v[1],y=Object(s.useState)(2),N=Object(r.a)(y,1)[0],$=g*N,D=$-N,w=h.slice(D,$),E=Object(u.useQuery)(C),_=Object(u.useLazyQuery)(k),F=Object(r.a)(_,2),R=F[0],P=F[1],A=Object(u.useMutation)(q),U=Object(r.a)(A,1)[0];Object(u.useSubscription)(I,{onSubscriptionData:function(e){var t=e.subscriptionData;!1===E.loading&&m(h.concat(t.data.reviewAdded))}});var T=Object(u.useApolloClient)(),L=function(e){R({variables:{categoryToSearch:e}})};return Object(s.useEffect)((function(){P.data&&b(P.data.findSameKindFood)}),[P]),Object(s.useEffect)((function(){!1===E.loading&&E.data&&m(E.data.findAllReviews)}),[E.data,E.loading]),Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"bg1",children:[Object(a.jsx)("div",{id:"caption",children:"Cappuccino"}),e.username?Object(a.jsxs)("div",{id:"caption-logout",children:["Hello, ",e.username,"!",Object(a.jsx)(l.b,{to:"/logout",onClick:function(){e.setToken(null),e.setRole(null),e.setUserID(null),e.setUsername(null),localStorage.clear(),T.resetStore()},children:"Log Out"})]}):Object(a.jsx)(l.b,{id:"caption-login",to:"/login",children:"Log In"}),Object(a.jsxs)("div",{id:"home-grid-container",children:[Object(a.jsx)(l.b,{id:"reservation",className:"btn btn-danger",to:"/reservation",children:"Reservation"}),Object(a.jsx)(l.b,{id:"deliver",className:"btn btn-danger",to:"/deliver",children:"Delivery"})]})]}),Object(a.jsxs)("div",{className:"menu-bar",children:[Object(a.jsx)("p",{id:"menu-caption",children:"Our Menu"}),Object(a.jsxs)("div",{className:"menu mb-5",children:[Object(a.jsx)("button",{className:"btn btn-info",onClick:function(){return L("coffee")},children:"Coffee"}),Object(a.jsx)("button",{className:"btn btn-info",onClick:function(){return L("food")},children:"Main Food"}),Object(a.jsx)("button",{className:"btn btn-info",onClick:function(){return L("dessert")},children:"Dessert"})]}),null===j?Object(a.jsx)("p",{className:"mt-5 text-center text-dark font-weight-bolder",children:"Welcome to Cappuccino! Please press button to see Menu"}):Object(a.jsxs)("table",{className:"table table-striped table-light mt-5",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col"}),Object(a.jsx)("th",{scope:"col"})]})}),Object(a.jsx)("tbody",{children:j.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsxs)("th",{scope:"row",children:[e.name,Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("small",{children:e.description})]}),Object(a.jsxs)("td",{children:["$",e.price]})]},e.id)}))})]})]}),Object(a.jsxs)("div",{className:"review",children:[Object(a.jsx)("h3",{children:"Reviews"}),null!==e.token?Object(a.jsx)("button",{onClick:function(){return i(!0)},children:Object(a.jsx)("i",{className:"fas fa-edit fa-2x"})}):Object(a.jsx)("p",{children:"Please Log in to write a review !"}),Object(a.jsx)("div",{id:"reviews",children:E.loading?Object(a.jsx)("p",{children:"Loading..."}):Object(a.jsx)("div",{className:"mt-5",children:w.map((function(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h5",{children:e.title}),Object(a.jsxs)("p",{children:["Created by ",e.user.username]}),Object(a.jsx)("p",{className:"pl-3",children:e.comment}),Object(a.jsx)("p",{id:"line",children:new Date(parseInt(e.date)).toLocaleString()})]},e.id)}))})}),Object(a.jsx)(M,{show:c,handleClose:function(){return i(!1)},addReview:U,userID:e.userID}),Object(a.jsx)(S,{postsPerPage:N,totalPosts:h.length,Paginate:function(e){return f(e)}})]})]})},_=function(e){var t=Object(u.useApolloClient)();return Object(a.jsx)("div",{className:"manager-nav-bigger",children:Object(a.jsxs)("div",{className:"manager-nav",children:[Object(a.jsx)(l.b,{className:"btn btn-primary",to:"/logout",onClick:function(){e.setToken(null),e.setRole(null),e.setUserID(null),e.setUsername(null),localStorage.clear(),t.resetStore()},children:"Log Out"}),Object(a.jsx)(l.b,{className:"btn btn-primary",to:"/manager/menu",children:" Menu "}),Object(a.jsx)(l.b,{className:"btn btn-primary",to:"/manager/reservation",children:" Reservation "}),Object(a.jsx)(l.b,{className:"btn btn-primary",to:"/manager/deliver",children:" Deliver "})]})})};function F(){var e=Object(g.a)(["\n  subscription {\n    ordered {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n  }\n"]);return F=function(){return e},e}function R(){var e=Object(g.a)(["\nmutation updateDeliverDelivered($id: ID!, $delivered: Boolean!) {\n    updateDeliverDelivered(\n        id: $id,\n        delivered: $delivered\n    ) {\n        id\n    }\n}\n"]);return R=function(){return e},e}function P(){var e=Object(g.a)(["\nmutation updateDeliverAccepted($id: ID!, $courtier: ID!, $accepted: Boolean!) {\n    updateDeliverAccepted(\n        id: $id,\n        courtier: $courtier,\n        accepted: $accepted\n    ) {\n        id\n    }\n}\n"]);return P=function(){return e},e}function A(){var e=Object(g.a)(["\nquery {\n    allDelivers {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n}\n"]);return A=function(){return e},e}var U=Object(u.gql)(A()),T=Object(u.gql)(P()),L=Object(u.gql)(R()),B=Object(u.gql)(F()),H=function(e){var t=Object(s.useState)([]),n=Object(r.a)(t,2),c=n[0],i=n[1],o={color:"red"},d={color:"green"},j=Object(u.useApolloClient)(),b=Object(u.useQuery)(U),O=Object(u.useMutation)(T),p=Object(r.a)(O,1)[0],h=Object(u.useMutation)(L),m=Object(r.a)(h,1)[0];Object(u.useSubscription)(B,{onSubscriptionData:function(e){var t=e.subscriptionData;i(c.concat(t.data.ordered))}}),Object(s.useEffect)((function(){b.data&&i(b.data.allDelivers)}),[b.data]);var x=function(e){var t=e.target.id.value,n=localStorage.getItem("userID");p({variables:{id:t,accepted:!0,courtier:n}})},v=function(e){var t=e.target.id.value;m({variables:{id:t,delivered:!0}})};return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:Object(a.jsx)(l.b,{to:"/logout",onClick:function(){e.setToken(null),e.setRole(null),e.setUserID(null),e.setUsername(null),localStorage.clear(),j.resetStore()},children:"Log Out"})}),Object(a.jsx)("div",{children:b.loading?Object(a.jsx)("div",{children:"loading..."}):Object(a.jsxs)("table",{className:"table",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"#"}),Object(a.jsx)("th",{scope:"col",children:"Purchase Date"}),Object(a.jsx)("th",{scope:"col",children:"Price"}),Object(a.jsx)("th",{scope:"col",children:"User"}),Object(a.jsx)("th",{scope:"col",children:"Phone"}),Object(a.jsx)("th",{scope:"col",children:"Street"}),Object(a.jsx)("th",{scope:"col",children:"Apt#"}),Object(a.jsx)("th",{scope:"col",children:"City"}),Object(a.jsx)("th",{scope:"col",children:"Postal Code"}),Object(a.jsx)("th",{scope:"col",children:"Accepted"}),Object(a.jsx)("th",{scope:"col",children:"Delivered"})]})}),Object(a.jsx)("tbody",{children:c.filter((function(e){return!0===e.ordered})).map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"row",children:e.id}),Object(a.jsx)("td",{children:new Date(parseInt(e.purchase_date)).toLocaleString()}),Object(a.jsx)("td",{children:e.price}),Object(a.jsx)("td",{children:e.user?e.user.username:"None"}),Object(a.jsx)("td",{children:e.info?e.info.phone:"None"}),Object(a.jsx)("td",{children:e.info?e.info.street:"None"}),Object(a.jsx)("td",{children:e.info?e.info.street2:"None"}),Object(a.jsx)("td",{children:e.info?e.info.city:"None"}),Object(a.jsx)("td",{children:e.info?e.info.postal_code:"None"}),Object(a.jsx)("td",{children:Object(a.jsxs)("form",{onSubmit:x,children:[Object(a.jsx)("input",{type:"hidden",name:"id",value:e.id}),Object(a.jsx)("button",{style:e.accepted?d:o,className:"btn btn-white",children:Object(a.jsx)("i",{className:"fas fa-check"})})]})}),Object(a.jsx)("td",{children:Object(a.jsxs)("form",{onSubmit:v,children:[Object(a.jsx)("input",{type:"hidden",name:"id",value:e.id}),Object(a.jsx)("button",{style:e.delivered?d:o,className:"btn btn-white",children:Object(a.jsx)("i",{className:"fas fa-check"})})]})})]},e.id)}))})]})})]})},z=n(17),K=n.n(z),Q=n(27),Z=function(e){var t=e.errorMessage,n=e.successMessage;return Object(a.jsxs)("div",{children:[t?Object(a.jsx)("div",{className:"alert alert-danger",role:"alert",children:t}):null,n?Object(a.jsx)("div",{className:"alert alert-success",role:"success",children:n}):null]})},G=n(100),W=n.n(G);function Y(){var e=Object(g.a)(["\nmutation addReservation($reservedAt: String!, $time: String!, $customers: Int!, $user: ID) {\n  addReservation(\n    reservedAt: $reservedAt\n    time: $time\n    customers: $customers\n    user: $user\n  ) {\n    reservedAt\n    time\n    customers\n  }\n}\n"]);return Y=function(){return e},e}var J=Object(u.gql)(Y()),V=function(e){var t=Object(p.b)(),n=Object(u.useMutation)(J),c=Object(r.a)(n,1)[0],s=function(){var n=Object(Q.a)(K.a.mark((function n(r){var a,s,i,o;return K.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),a=r.target.date.value,s=r.target.time.value,i=parseInt(r.target.customers.value),o=e.userID,null===e.userID){n.next=17;break}return n.prev=6,n.next=9,c({variables:{reservedAt:a,time:s,customers:i,user:o}});case 9:n.next=14;break;case 11:n.prev=11,n.t0=n.catch(6),e.setError(n.t0.message);case 14:W.a.sendForm("service_d7tzr1g","template_od0ql1o",r.target,"user_uLpm5LanNOvUTRchkjsAS").then((function(t){e.setSuccess("Book successfully!")}),(function(t){e.setError(t.text)})),n.next=19;break;case 17:t({type:"BOOK_TIME",data:{reservedAt:a,time:s,customers:i}}),e.setReserve(!0);case 19:r.target.date.value="",r.target.time.value="",r.target.customers.value=null;case 22:case"end":return n.stop()}}),n,null,[[6,11]])})));return function(e){return n.apply(this,arguments)}}();return Object(a.jsx)("div",{className:"reservation",children:Object(a.jsx)("div",{className:"bg2",children:Object(a.jsxs)("div",{className:"reservation-bigger-form",children:[Object(a.jsxs)("div",{id:"reserve-bg",children:[Object(a.jsx)(Z,{errorMessage:e.errorMessage,successMessage:e.successMessage}),Object(a.jsxs)("form",{className:"reservation-form",onSubmit:s,children:[Object(a.jsx)("input",{type:"hidden",name:"email",value:e.email?e.email:""}),Object(a.jsx)("input",{type:"date",name:"date",required:!0}),Object(a.jsxs)("select",{name:"time",required:!0,children:[Object(a.jsx)("option",{value:"9:00 a.m.",children:"9:00 a.m."}),Object(a.jsx)("option",{value:"10:30 a.m.",children:"10:30 a.m."}),Object(a.jsx)("option",{value:"12:00 p.m.",children:"12:00 p.m."}),Object(a.jsx)("option",{value:"1:30 p.m.",children:"1:30 p.m."}),Object(a.jsx)("option",{value:"3:00 p.m.",children:"3:00 p.m."}),Object(a.jsx)("option",{value:"4:30 p.m.",children:"4:30 p.m."}),Object(a.jsx)("option",{value:"6:00 p.m.",children:"6:00 p.m."})]}),Object(a.jsx)("input",{type:"number",min:"1",max:"6",placeholder:"customer(s)",name:"customers",required:!0}),Object(a.jsx)("input",{className:"btn btn-danger py-3 px-5",type:"submit",value:"Reserve Now"})]})]}),Object(a.jsx)("div",{className:"reservation-link",children:Object(a.jsx)(l.b,{className:"btn btn-info py-3 px-5",to:"/",children:"Go back Home"})})]})})})},X=n(101),ee=n.n(X);function te(){var e=Object(g.a)(["\nmutation addReservation($reservedAt: String!, $time: String!, $customers: Int!, $email: String, $phone: String) {\n  addReservation(\n    reservedAt: $reservedAt\n    time: $time\n    customers: $customers\n    email: $email\n    phone: $phone\n  ) {\n    reservedAt\n    time\n    customers\n  }\n}\n"]);return te=function(){return e},e}var ne=Object(u.gql)(te()),re=function(e){var t=e.setReserve,n=e.setError,c=e.setSuccess,s=e.errorMessage,i=e.successMessage,o=Object(u.useMutation)(ne),d=Object(r.a)(o,1)[0],j=Object(p.c)((function(e){return e.books})),b=function(){var e=Object(Q.a)(K.a.mark((function e(r){var a,s,i,o,l,u;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),a=r.target.email.value,s=r.target.phone.value,r.target.email.value="",r.target.phone.value="",i=j.reservedAt,o=j.time,l=parseInt(j.customers),e.prev=8,e.next=11,d({variables:{reservedAt:i,time:o,customers:l,email:a,phone:s}});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),n(e.t0.message);case 16:u={service_id:"service_d7tzr1g",template_id:"template_od0ql1o",user_id:"user_uLpm5LanNOvUTRchkjsAS",template_params:{date:i,time:o,customers:l,email:a}},ee.a.post("https://api.emailjs.com/api/v1.0/email/send",u).then((function(e){c("Book successfully!")}),(function(e){n(JSON.stringify(e.message))})),t(!1);case 19:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"book-bigger",children:[Object(a.jsxs)("form",{onSubmit:b,className:"reservation-book-form",children:[Object(a.jsx)(Z,{errorMessage:s,successMessage:i}),Object(a.jsx)("input",{type:"text",placeholder:"E-mail",name:"email",required:!0}),Object(a.jsx)("input",{type:"text",placeholder:"Phone",name:"phone",required:!0}),Object(a.jsx)("input",{type:"submit",value:"Book Now"}),Object(a.jsxs)("small",{children:["want to ",Object(a.jsx)(l.b,{to:"/login",children:"login"})," ?"]}),Object(a.jsxs)("small",{children:["Register as a ",Object(a.jsx)(l.b,{to:"/register",children:"user"}),"?"]})]}),Object(a.jsx)("div",{className:"reservation-link",children:Object(a.jsx)(l.b,{className:"btn btn-info py-3 px-5",to:"/",children:"Go back Home"})})]})},ce=n.p+"static/media/food.46d5773f.jpg",ae=n.p+"static/media/coffee.e40e6214.jpg",se=n.p+"static/media/dessert.b41b956d.jpg",ie=function(e){var t=e.show,n=e.handleClose,r=e.quantity,c=e.setQuantity,s=e.food,i=e.handleSubmit;return Object(a.jsx)("div",{children:Object(a.jsx)(f.a,{show:t,onHide:n,children:Object(a.jsxs)("form",{onSubmit:i,children:[Object(a.jsx)(f.a.Header,{closeButton:!0,children:Object(a.jsx)(f.a.Title,{children:s.name})}),Object(a.jsx)(f.a.Body,{children:Object(a.jsxs)("b",{id:"quantity",children:["Quantity:",Object(a.jsx)("input",{type:"hidden",name:"item",value:s.id}),Object(a.jsx)("input",{type:"hidden",name:"name",value:s.name}),Object(a.jsx)("input",{type:"hidden",name:"price",value:(r*s.price).toFixed(2)}),Object(a.jsx)("button",{type:"button",onClick:function(){c(r>1?r-1:1)},className:"pr-4",children:Object(a.jsx)("i",{className:"fas fa-minus fa-lg"})}),Object(a.jsx)("input",{value:r,name:"quantity",className:"text-center",onChange:function(e){return e}}),Object(a.jsxs)("button",{type:"button",onClick:function(){c(r+1)},className:"pr-4",children:[Object(a.jsx)("i",{className:"fas fa-plus fa-lg"})," "]}),Object(a.jsxs)("p",{children:["Price: $ ",(r*s.price).toFixed(2)]})]})}),Object(a.jsxs)(f.a.Footer,{children:[Object(a.jsx)(y.a,{variant:"secondary",type:"submit",onClick:n,children:"Close"}),Object(a.jsx)("input",{type:"submit",value:"Save Changes"})]})]})})})},oe=function(e){var t=e.menu,n=e.category,i=e.picture,o=Object(p.b)(),l=function(e){e.preventDefault(),o({type:"ORDER_FOOD",data:{item:e.target.item.value,name:e.target.name.value,quantity:parseInt(e.target.quantity.value),price:parseFloat(e.target.price.value).toFixed(2)}})},d=Object(s.useState)(1),u=Object(r.a)(d,2),j=u[0],b=u[1],O=Object(s.useState)(t.reduce((function(e,t){return e[t.id]=!1,e}),{})),h=Object(r.a)(O,2),m=h[0],x=h[1],v=function(e){return function(){var t=Object(c.a)({},m);t[e]=!0,x(t)}};return Object(a.jsx)("div",{id:"menu-grid",children:t.filter((function(e){return e.category===n})).map((function(e){return Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"card mb-3",id:"card-height",children:Object(a.jsxs)("div",{className:"row no-gutters",children:[Object(a.jsx)("div",{className:"col-md-4",children:Object(a.jsx)("img",{src:i,width:"100",height:"200",className:"card-img",alt:e.category,onClick:v(e.id)})}),Object(a.jsx)("div",{className:"col-md-8",children:Object(a.jsxs)("div",{className:"card-body",children:[Object(a.jsx)("h5",{className:"card-title",onClick:v(e.id),children:e.name}),Object(a.jsx)(ie,{show:m[e.id],handleClose:(t=e.id,function(){b(1);var e=Object(c.a)({},m);e[t]=!1,x(e)}),quantity:j,setQuantity:b,food:e,handleSubmit:l}),Object(a.jsx)("p",{className:"card-text",onClick:v(e.id),children:e.description}),Object(a.jsx)("p",{className:"card-text",children:Object(a.jsxs)("small",{className:"text-muted",children:["$ ",e.price]})})]})})]})})},e.id);var t}))})},le=function(e){var t=e.menu,n=e.userID,r=[ae,ce,se];return Object(a.jsx)("div",{children:["coffee","food","dessert"].map((function(e,c){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{id:e,className:"mt-5",children:e.toUpperCase()}),Object(a.jsx)(oe,{menu:t,userID:n,category:e,picture:r[c]})]},c)}))})};function de(){var e=Object(g.a)(["\nquery {\n  allFood  {\n    name\n    description\n    category\n    price\n    id\n  }\n}\n"]);return de=function(){return e},e}var ue=Object(u.gql)(de()),je=function(e){var t=Object(d.g)(),n=Object(p.b)(),r=Object(u.useQuery)(ue),c=Object(p.c)((function(e){return e.orders})),s=c.reduce((function(e,t){return e+parseFloat(t.price)}),0);return Object(a.jsx)("div",{className:"deliver p-5",children:Object(a.jsxs)("div",{className:"deliver-page",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"bg3"}),Object(a.jsxs)("div",{className:"deliver-bar",children:[Object(a.jsx)("a",{href:"#coffee",children:"Coffee"}),Object(a.jsx)("a",{href:"#food",children:"Main Food"}),Object(a.jsx)("a",{href:"#dessert",children:"Dessert"})]}),r.loading?Object(a.jsx)("p",{children:"Loading..."}):Object(a.jsx)(le,{menu:r.data.allFood,userID:e.userID})]}),Object(a.jsxs)("div",{className:"cart",children:[Object(a.jsx)("h5",{children:"Shopping Cart"}),Object(a.jsx)("table",{className:"table",children:Object(a.jsx)("tbody",{children:c.map((function(e,t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:e.name}),Object(a.jsx)("td",{children:e.quantity}),Object(a.jsxs)("td",{children:["$ ",e.price]}),Object(a.jsx)("td",{children:Object(a.jsx)("button",{onClick:function(){return t=e.item,void n({type:"DELETE_FOOD",data:{item:t}});var t},className:"btn btn-light",children:Object(a.jsx)("i",{className:"fas fa-trash-alt"})})})]},t)}))})}),Object(a.jsxs)("h5",{children:["Total Price: $",s.toFixed(2)]}),Object(a.jsx)("button",{onClick:function(){null===e.userID?t.push("/deliver/signup"):t.push("/checkout")},children:"Check Out"})]})]})})};function be(){var e=Object(g.a)(["\nmutation stripeCharge($amount: Float!) {\n    stripeCharge(\n        amount: $amount\n    ) {\n        clientSecret\n    }\n}"]);return be=function(){return e},e}function Oe(){var e=Object(g.a)(["\nmutation createDeliver($orderlist: [OrderEntry]!, $price: Float!, $ordered: Boolean!, $user: ID, $email: String, $phone: String, $street: String, $street2: String, $city: String, $postal_code: String) {\n    createDeliver(\n        orderlist: $orderlist\n        price: $price\n        ordered: $ordered\n        user: $user\n        email: $email\n        phone: $phone\n        street: $street\n        street2: $street2\n        city: $city\n        postal_code: $postal_code\n    ) {\n        id\n    }\n}"]);return Oe=function(){return e},e}var pe=Object(u.gql)(Oe()),he=Object(u.gql)(be()),me=function(){var e=Object(p.b)(),t=Object(u.useMutation)(pe),n=Object(r.a)(t,2),c=n[0],i=n[1],o=Object(u.useMutation)(he),j=Object(r.a)(o,2),b=j[0],O=j[1],h=Object(p.c)((function(e){return e.orders})),m=Object(d.g)(),v=Object(x.useStripe)(),g=Object(x.useElements)(),f=Object(s.useState)(null),y=Object(r.a)(f,2),S=y[0],N=y[1],$=function(){var e=Object(Q.a)(K.a.mark((function e(t){var n,r,a,s,i,o,l,d,u,j,O;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=h.map((function(e){return{item:e.item,quantity:e.quantity,price:parseFloat(e.price)}})),r=h.reduce((function(e,t){return e+parseFloat(t.price)}),0),!0,a=t.target.email.value,s=t.target.phone.value,i=t.target.street.value,o=t.target.street2.value,l=t.target.city.value,d=t.target.postal_code.value,u=100*parseFloat(r),j={name:"Daisy",email:a,phone:s,address:{city:l,line1:i,line2:o,state:"ON",postal_code:d}},e.prev=12,e.next=15,c({variables:{orderlist:n,price:r,ordered:true,email:a,phone:s,street:i,street2:o,city:l,postal_code:d}});case 15:return e.next=17,b({variables:{amount:u}});case 17:return e.next=19,v.createPaymentMethod({type:"card",card:g.getElement(x.CardElement),billing_details:j});case 19:O=e.sent,N(O),e.next=25;break;case 23:e.prev=23,e.t0=e.catch(12);case 25:t.target.email.value="",t.target.phone.value="",t.target.street.value="",t.target.street2.value="",t.target.city.value="",t.target.postal_code.value="",setTimeout((function(){return m.push("/delivering")}),5e3);case 32:case"end":return e.stop()}}),e,null,[[12,23]])})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){i.data&&e({type:"DELIVER_ID",data:{id:i.data.createDeliver.id}}),function(){var e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=3;break}return e.next=3,v.confirmCardPayment(O.data.stripeCharge.clientSecret,{payment_method:S.paymentMethod.id});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i.data,O.data,S]);return Object(a.jsxs)("div",{className:"reservation2-bigger",children:[Object(a.jsxs)("form",{className:"reservation2-grid",onSubmit:$,children:[Object(a.jsx)("input",{type:"text",name:"email",placeholder:"E-mail"}),Object(a.jsx)("input",{type:"text",name:"phone",placeholder:"Phone"}),Object(a.jsx)("input",{type:"text",name:"street",placeholder:"Street"}),Object(a.jsx)("input",{type:"text",name:"street2",placeholder:"Street2"}),Object(a.jsx)("input",{type:"text",name:"city",placeholder:"City"}),Object(a.jsx)("input",{type:"text",name:"postal_code",placeholder:"Postal Code"}),Object(a.jsx)(x.CardElement,{options:{style:{base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},hidePostalCode:!0}}),Object(a.jsx)("input",{type:"submit",value:"Deliver Now"})]}),Object(a.jsxs)("small",{className:"mt-3",children:["want to ",Object(a.jsx)(l.b,{to:"/login",children:"login"})," ?"]}),Object(a.jsxs)("small",{children:["Register as a ",Object(a.jsx)(l.b,{to:"/register",children:"user"}),"?"]})]})};function xe(){var e=Object(g.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(\n      username: $username,\n      password: $password\n    ) {\n      value\n      username\n      id\n      role\n      email\n    }\n  }\n"]);return xe=function(){return e},e}var ve=Object(u.gql)(xe()),ge=function(e){var t=Object(u.useMutation)(ve),n=Object(r.a)(t,2),c=n[0],i=n[1];Object(s.useEffect)((function(){if(i.data){var t=i.data.login.value,n=i.data.login.username,r=i.data.login.id,c=i.data.login.role,a=i.data.login.email;e.setToken(t),e.setUsername(n),e.setUserID(r),e.setRole(c),e.setEmail(a),e.setReserve(!1),localStorage.setItem("token",t),localStorage.setItem("username",n),localStorage.setItem("userID",r),localStorage.setItem("role",c),localStorage.setItem("email",a)}}),[e,i.data]);var o=function(){var t=Object(Q.a)(K.a.mark((function t(n){var r,a;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=n.target.username.value,a=n.target.pwd.value,t.prev=3,t.next=6,c({variables:{username:r,password:a}});case 6:e.setSuccess("Logged in!"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),e.setError(t.t0.message);case 12:n.target.username.value="",n.target.pwd.value="";case 14:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"login-bigger",children:[Object(a.jsx)("h4",{children:"Log In Here"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsxs)("form",{className:"login-form",onSubmit:o,children:[Object(a.jsx)(Z,{errorMessage:e.errorMessage,successMessage:e.successMessage}),Object(a.jsx)("input",{type:"text",name:"username",placeholder:"Username"}),Object(a.jsx)("input",{type:"password",name:"pwd",placeholder:"Password"}),Object(a.jsx)("input",{type:"submit",value:"Log In"}),Object(a.jsxs)("small",{children:["Don't have an account yet? Register as a ",Object(a.jsx)(l.b,{to:"/register",children:"user"}),"."]})]})]})};function fe(){var e=Object(g.a)(["\nmutation createUser($username: String!, $name: String, $passwordHash: String!, $role: String!, $email: String!, $phone: String!, $street: String!, $street2: String, $city: String!, $postal_code: String!) {\n  createUser(\n    username: $username,\n    name: $name,\n    passwordHash: $passwordHash,\n    role: $role,\n    email: $email,\n    phone: $phone,\n    street: $street,\n    street2: $street2,\n    city: $city,\n    postal_code: $postal_code\n  ) {\n    username\n  }\n}\n"]);return fe=function(){return e},e}var ye=Object(u.gql)(fe()),Se=function(e){var t=Object(u.useMutation)(ye),n=Object(r.a)(t,2),c=n[0],i=n[1],o={username:/^[\w]{1,30}$/,pwd:/^[\w-]{1,30}$/,email:/^([a-zA-Z\d\.-]+)@([a-zA-Z\d-]+)\.([a-z{2,8}])(\.[a-z]{2,8})?$/,phone:/^\d{11}$/,street:/^[a-zA-Z\d\s]{1,50}$/,city:/^[a-zA-Z]{1,30}$/,postal_code:/^[a-zA-Z\d]{6,10}$/},l={username:"Username must contain lettes, digits and _, within 1~30",pwd:"Password must contain lettes, digits, _, and -, within 1~30",email:"Example: dai@gmail.com",phone:"11 digits",street:"within 50 letters",city:"within 30 letters",postal_code:"Example: L5G 20R or 230013"},d=function(t){o[t.target.attributes.name.value].test(t.target.value)||e.setError(l[t.target.attributes.name.value])},j=function(){var t=Object(Q.a)(K.a.mark((function t(n){var r,a,s,i,o,l,d,u,j,b;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=n.target.username.value,a=n.target.name.value,s=n.target.pwd.value,i=n.target.role.value,o=n.target.email.value,l=n.target.phone.value,d=n.target.street.value,u=n.target.street2.value,j=n.target.city.value,b=n.target.postal_code.value,t.prev=11,t.next=14,c({variables:{username:r,name:a,passwordHash:s,role:i,email:o,phone:l,street:d,street2:u,city:j,postal_code:b}});case 14:e.setSuccess("Register Successfully, please log in !"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11),e.setError(t.t0.message);case 20:n.target.username.value="",n.target.name.value="",n.target.pwd.value="",n.target.role.value="",n.target.email.value="",n.target.phone.value="",n.target.street.value="",n.target.street2.value="",n.target.city.value="",n.target.postal_code.value="";case 30:case"end":return t.stop()}}),t,null,[[11,17]])})));return function(e){return t.apply(this,arguments)}}();return Object(s.useEffect)((function(){i.data&&e.setRegister(!0)}),[e,i.data]),Object(a.jsxs)("div",{className:"register-bigger",children:[Object(a.jsx)("h4",{children:"Register Here"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsxs)("form",{className:"register-form",onSubmit:j,children:[Object(a.jsx)(Z,{errorMessage:e.errorMessage,successMessage:e.successMessage}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"username",placeholder:"Username",required:!0}),Object(a.jsx)("input",{type:"text",name:"name",placeholder:"Name"}),Object(a.jsxs)("div",{className:"role-radio",children:[Object(a.jsxs)("div",{className:"role",children:[Object(a.jsx)("input",{type:"radio",name:"role",value:"manager",required:!0}),Object(a.jsx)("label",{children:"Manager"})]}),Object(a.jsxs)("div",{className:"role",children:[Object(a.jsx)("input",{type:"radio",name:"role",value:"courtier",required:!0}),Object(a.jsx)("label",{children:"Courier"})]}),Object(a.jsxs)("div",{className:"role",children:[Object(a.jsx)("input",{type:"radio",name:"role",value:"user",required:!0}),Object(a.jsx)("label",{children:"User"})]})]}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"email",placeholder:"E-mail",required:!0}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"phone",placeholder:"Phone",required:!0}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"street",placeholder:"Street",required:!0}),Object(a.jsx)("input",{type:"text",name:"street2",placeholder:"Your partment No."}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"city",placeholder:"City",required:!0}),Object(a.jsx)("input",{onKeyUp:d,type:"text",name:"postal_code",placeholder:"Postal Code",required:!0}),Object(a.jsx)("input",{onKeyUp:d,type:"password",name:"pwd",placeholder:"Password",required:!0}),Object(a.jsx)("input",{type:"submit",value:"Register"})]})]})};function Ne(){var e=Object(g.a)(["\nmutation stripeCharge($amount: Float!) {\n    stripeCharge(\n        amount: $amount\n    ) {\n        clientSecret\n    }\n}"]);return Ne=function(){return e},e}function $e(){var e=Object(g.a)(["\nmutation createDeliver($orderlist: [OrderEntry]!, $price: Float!, $ordered: Boolean!, $user: ID, $email: String, $phone: String, $street: String, $street2: String, $city: String, $postal_code: String) {\n    createDeliver(\n        orderlist: $orderlist\n        price: $price\n        ordered: $ordered\n        user: $user\n        email: $email\n        phone: $phone\n        street: $street\n        street2: $street2\n        city: $city\n        postal_code: $postal_code\n    ) {\n        id\n    }\n}"]);return $e=function(){return e},e}var De=Object(u.gql)($e()),we=Object(u.gql)(Ne()),ke=function(e){var t=Object(p.b)(),n=Object(u.useMutation)(De),c=Object(r.a)(n,2),i=c[0],o=c[1],l=Object(u.useMutation)(we),j=Object(r.a)(l,2),b=j[0],O=j[1],h=Object(s.useState)(null),m=Object(r.a)(h,2),v=m[0],g=m[1],f=Object(d.g)(),y=Object(p.c)((function(e){return e.orders})),S=Object(x.useStripe)(),N=Object(x.useElements)(),$=function(){var t=Object(Q.a)(K.a.mark((function t(n){var r,c,a,s,o;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=y.map((function(e){return{item:e.item,quantity:e.quantity,price:parseFloat(e.price)}})),c=y.reduce((function(e,t){return e+parseFloat(t.price)}),0),!0,a=e.userID,s=100*parseFloat(c),t.prev=6,t.next=9,i({variables:{orderlist:r,price:c,ordered:true,user:a}});case 9:return t.next=11,b({variables:{amount:s}});case 11:return t.next=13,S.createPaymentMethod({type:"card",card:N.getElement(x.CardElement)});case 13:o=t.sent,g(o),t.next=19;break;case 17:t.prev=17,t.t0=t.catch(6);case 19:setTimeout((function(){return f.push("/delivering")}),5e3);case 20:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e){return t.apply(this,arguments)}}();Object(s.useEffect)((function(){o.data&&t({type:"DELIVER_ID",data:{id:o.data.createDeliver.id}}),function(){var e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=3;break}return e.next=3,S.confirmCardPayment(O.data.stripeCharge.clientSecret,{payment_method:v.paymentMethod.id});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[o.data,O.data,v]);return Object(a.jsxs)("div",{className:"form-checkout-bigger",children:[Object(a.jsx)("h2",{children:"Checkout Form"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsxs)("form",{onSubmit:$,className:"form-checkout",children:[Object(a.jsx)(x.CardElement,{options:{style:{base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},hidePostalCode:!0}}),Object(a.jsx)("button",{type:"submit",children:"Deliver Now"})]})]})};function Ce(){var e=Object(g.a)(["  \n  subscription {\n    delivered {\n      id\n    }\n  }\n"]);return Ce=function(){return e},e}function qe(){var e=Object(g.a)(["  \n  subscription {\n    accepted {\n      id\n    }\n  }\n"]);return qe=function(){return e},e}var Ie=Object(u.gql)(qe()),Me=Object(u.gql)(Ce()),Ee=function(e){var t=Object(p.c)((function(e){return e.deliverid})),n=Object(p.c)((function(e){return e.orders})),c=n.reduce((function(e,t){return e+parseFloat(t.price)}),0),i=Object(s.useState)(t?t.id:null),o=Object(r.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(r.a)(j,2),O=b[0],h=b[1],m=Object(s.useState)(!1),x=Object(r.a)(m,2),v=x[0],g=x[1];return Object(u.useSubscription)(Ie,{onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data.accepted.id),h(!0)}}),Object(u.useSubscription)(Me,{onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data.delivered.id),g(!0)}}),Object(s.useEffect)((function(){O||v||e.setSuccess("Your order # ".concat(l," has been ordered successfully. Please wait for courtier to pick up!")),O&&!v&&e.setSuccess("Your order # ".concat(l," has been picked up. Your courtier is on the way..."))}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)(Z,{errorMessage:e.errorMessage,successMessage:e.successMessage}),Object(a.jsxs)("div",{className:"order-list",children:[Object(a.jsx)("h2",{children:"Order List"}),Object(a.jsx)("table",{className:"table table-delivering",children:Object(a.jsx)("tbody",{children:n.map((function(e,t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:e.name}),Object(a.jsx)("td",{children:e.quantity}),Object(a.jsxs)("td",{children:["$ ",e.price]})]},t)}))})}),Object(a.jsxs)("h5",{children:["Total Price: $",c.toFixed(2)]})]})]})};function _e(){var e=Object(g.a)(["  \n  subscription {\n    delivered {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n  }\n"]);return _e=function(){return e},e}function Fe(){var e=Object(g.a)(["  \n  subscription {\n    accepted {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n  }\n"]);return Fe=function(){return e},e}function Re(){var e=Object(g.a)(["\n  subscription {\n    ordered {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n  }\n"]);return Re=function(){return e},e}function Pe(){var e=Object(g.a)(["\nquery {\n    allDelivers {\n      purchase_date\n      price\n      ordered\n      accepted\n      delivered\n      id\n      user {\n        username\n      }\n      courtier {\n        username\n      }\n      info {\n        email\n        phone\n        street\n        street2\n        city\n        postal_code\n      }\n    }\n}\n"]);return Pe=function(){return e},e}var Ae=Object(u.gql)(Pe()),Ue=Object(u.gql)(Re()),Te=Object(u.gql)(Fe()),Le=Object(u.gql)(_e()),Be=function(){var e=Object(s.useState)([]),t=Object(r.a)(e,2),n=t[0],c=t[1],i={color:"red"},o={color:"green"},d=Object(u.useQuery)(Ae);return Object(u.useSubscription)(Ue,{onSubscriptionData:function(e){var t=e.subscriptionData;c(n.concat(t.data.ordered))}}),Object(u.useSubscription)(Te,{onSubscriptionData:function(e){var t=e.subscriptionData;c(n.map((function(e){return e.id===t.data.accepted.id?t.data.accepted:e})))}}),Object(u.useSubscription)(Le,{onSubscriptionData:function(e){var t=e.subscriptionData;c(n.map((function(e){return e.id===t.data.delivered.id?t.data.delivered:e})))}}),Object(s.useEffect)((function(){d.data&&c(d.data.allDelivers)}),[d.data]),Object(a.jsxs)("div",{children:[Object(a.jsx)(l.b,{to:"/manager",children:"Main Page"}),Object(a.jsx)("div",{children:d.loading?Object(a.jsx)("div",{children:"loading..."}):Object(a.jsxs)("table",{className:"table",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"#"}),Object(a.jsx)("th",{scope:"col",children:"Purchase Date"}),Object(a.jsx)("th",{scope:"col",children:"Price"}),Object(a.jsx)("th",{scope:"col",children:"User"}),Object(a.jsx)("th",{scope:"col",children:"Phone"}),Object(a.jsx)("th",{scope:"col",children:"Street"}),Object(a.jsx)("th",{scope:"col",children:"Apt#"}),Object(a.jsx)("th",{scope:"col",children:"City"}),Object(a.jsx)("th",{scope:"col",children:"Postal Code"}),Object(a.jsx)("th",{scope:"col",children:"Accepted"}),Object(a.jsx)("th",{scope:"col",children:"Delivered"})]})}),Object(a.jsx)("tbody",{children:n.filter((function(e){return!0===e.ordered})).map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"row",children:e.id}),Object(a.jsx)("td",{children:new Date(parseInt(e.purchase_date)).toLocaleString()}),Object(a.jsx)("td",{children:e.price}),Object(a.jsx)("td",{children:e.user?e.user.username:"None"}),Object(a.jsx)("td",{children:e.info?e.info.phone:"None"}),Object(a.jsx)("td",{children:e.info?e.info.street:"None"}),Object(a.jsx)("td",{children:e.info?e.info.street2:"None"}),Object(a.jsx)("td",{children:e.info?e.info.city:"None"}),Object(a.jsx)("td",{children:e.info?e.info.postal_code:"None"}),Object(a.jsx)("td",{children:Object(a.jsx)("button",{style:e.accepted?o:i,className:"btn btn-white",children:Object(a.jsx)("i",{className:"fas fa-check"})})}),Object(a.jsx)("td",{children:Object(a.jsx)("button",{style:e.delivered?o:i,className:"btn btn-white",children:Object(a.jsx)("i",{className:"fas fa-check"})})})]},e.id)}))})]})})]})};function He(){var e=Object(g.a)(["\nmutation updateReservationCheck($id: ID!, $check: Boolean!) {\n  updateReservationCheck(\n    id: $id\n    check: $check\n  ) {\n    id\n  }\n}\n"]);return He=function(){return e},e}function ze(){var e=Object(g.a)(["\nquery {\n  allReservations {\n    reservedAt\n    time\n    customers\n    email\n    phone\n    check\n    id\n    user {\n      username\n    }\n  }\n}\n"]);return ze=function(){return e},e}var Ke=Object(u.gql)(ze()),Qe=Object(u.gql)(He()),Ze=function(){var e=Object(u.useQuery)(Ke),t=Object(u.useMutation)(Qe),n=Object(r.a)(t,1)[0],c={color:"red"},s={color:"green"},i=function(e){var t=e.target.id.value;n({variables:{id:t,check:!0}})};return Object(a.jsxs)("div",{children:[Object(a.jsx)("h6",{className:"text-center my-5",children:Object(a.jsx)(l.b,{to:"/manager",children:"Main Page"})}),Object(a.jsx)("div",{className:"reservation-manager-display",children:e.loading?Object(a.jsx)("div",{children:"loading..."}):Object(a.jsxs)("table",{className:"table",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"Reservation Date"}),Object(a.jsx)("th",{scope:"col",children:"Reservation Time"}),Object(a.jsx)("th",{scope:"col",children:"Number of Customers"}),Object(a.jsx)("th",{scope:"col",children:"Email"}),Object(a.jsx)("th",{scope:"col",children:"Phone"}),Object(a.jsx)("th",{scope:"col",children:"Username"}),Object(a.jsx)("th",{scope:"col",children:"Accepted"})]})}),Object(a.jsx)("tbody",{children:e.data.allReservations.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"row",children:e.reservedAt}),Object(a.jsx)("td",{children:e.time}),Object(a.jsx)("td",{children:e.customers}),Object(a.jsx)("td",{children:e.email?e.email:"None"}),Object(a.jsx)("td",{children:e.phone?e.phone:"None"}),Object(a.jsx)("td",{children:e.user?e.user.username:"None"}),Object(a.jsx)("td",{children:Object(a.jsxs)("form",{onSubmit:i,children:[Object(a.jsx)("input",{type:"hidden",value:e.id,name:"id"}),Object(a.jsx)("button",{className:"btn btn-white",type:"submit",children:Object(a.jsx)("i",{style:e.check?s:c,className:"fas fa-check"})})]})})]},e.id)}))})]})})]})};function Ge(){var e=Object(g.a)(["\nmutation deleteFood($id: ID!) {\n  deleteFood(\n    id: $id\n  ) {\n    id\n  }\n}\n"]);return Ge=function(){return e},e}function We(){var e=Object(g.a)(["\nmutation updateFoodPrice($id: ID!, $price: Float!) {\n  updateFoodPrice(\n    id: $id\n    price: $price\n  ) {\n    id\n  }\n}\n"]);return We=function(){return e},e}function Ye(){var e=Object(g.a)(["\nmutation addFood($name: String!, $description: String!, $category: String!, $price: Float!) {\n  addFood(\n    name: $name\n    description: $description\n    category: $category\n    price: $price\n  ) {\n    id\n  }\n}\n"]);return Ye=function(){return e},e}function Je(){var e=Object(g.a)(["\nquery {\n  allFood  {\n    name\n    description\n    category\n    price\n    id\n  }\n}\n"]);return Je=function(){return e},e}var Ve=Object(u.gql)(Je()),Xe=Object(u.gql)(Ye()),et=Object(u.gql)(We()),tt=Object(u.gql)(Ge()),nt=function(e){var t=e.show,n=e.handleClose,r=e.updateFoodPrice,c=e.id;return Object(a.jsx)("div",{children:Object(a.jsx)(f.a,{show:t,onHide:n,children:Object(a.jsxs)("form",{onSubmit:function(e){var t=parseFloat(e.target.price.value);r({variables:{id:c,price:t}}),e.target.price.value=""},children:[Object(a.jsx)(f.a.Header,{closeButton:!0,children:Object(a.jsx)(f.a.Title,{children:"Update Price"})}),Object(a.jsx)(f.a.Body,{children:Object(a.jsx)("input",{text:"type",name:"price",placeholder:"Change Price"})}),Object(a.jsxs)(f.a.Footer,{children:[Object(a.jsx)(y.a,{type:"button",variant:"secondary",onClick:n,children:"Close"}),Object(a.jsx)(y.a,{type:"submit",variant:"primary",onClick:n,children:"Save Changes"})]})]})})})},rt=function(){var e=Object(s.useState)({}),t=Object(r.a)(e,2),n=t[0],i=t[1],o=Object(s.useState)([]),d=Object(r.a)(o,2),j=d[0],b=d[1],O=Object(u.useQuery)(Ve),p=Object(u.useMutation)(Xe),h=Object(r.a)(p,1)[0],m=Object(u.useMutation)(et),x=Object(r.a)(m,1)[0],v=Object(u.useMutation)(tt),g=Object(r.a)(v,1)[0];Object(s.useEffect)((function(){O.data&&b(O.data.allFood)}),[O.data]),Object(s.useEffect)((function(){i(j.reduce((function(e,t){return e[t.id]=!1,e}),{}))}),[j]);var f=function(e){return function(){var t=Object(c.a)({},n);t[e]=!1,i(t)}},y=function(e){var t=e.target.id.value;g({variables:{id:t}})};return Object(a.jsxs)("div",{children:[O.loading?Object(a.jsx)("div",{children:"Loading..."}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{className:"text-center my-5",children:"Menu"}),Object(a.jsx)("h6",{className:"text-center my-5",children:Object(a.jsx)(l.b,{to:"/manager",children:" Main Page "})}),Object(a.jsxs)("table",{className:"table table-dark",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"Name"}),Object(a.jsx)("th",{scope:"col",children:"Description"}),Object(a.jsx)("th",{scope:"col",children:"Category"}),Object(a.jsx)("th",{scope:"col",children:"Price"}),Object(a.jsx)("th",{scope:"col"})]})}),Object(a.jsx)("tbody",{children:j.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"row",children:e.name}),Object(a.jsx)("td",{children:e.description}),Object(a.jsx)("td",{children:e.category}),Object(a.jsxs)("td",{children:[Object(a.jsxs)("p",{children:["$",e.price]}),Object(a.jsx)("button",{className:"btn btn-dark",onClick:(t=e.id,function(){var e=Object(c.a)({},n);e[t]=!0,i(e)}),children:Object(a.jsx)("i",{className:"fas fa-edit"})}),Object(a.jsx)(nt,{show:n[e.id],handleClose:f(e.id),updateFoodPrice:x,id:e.id})]}),Object(a.jsx)("td",{children:Object(a.jsxs)("form",{onSubmit:y,children:[Object(a.jsx)("input",{type:"hidden",name:"id",value:e.id}),Object(a.jsx)("button",{type:"submit",className:"btn btn-dark",children:Object(a.jsx)("i",{className:"fas fa-trash-alt"})})]})})]},e.id);var t}))})]})]}),Object(a.jsx)("div",{className:"menu-manager-bigger",children:Object(a.jsxs)("form",{onSubmit:function(e){var t=e.target.name.value,n=e.target.description.value,r=e.target.category.value,c=parseFloat(e.target.price.value);h({variables:{name:t,description:n,category:r,price:c}}),e.target.name.value="",e.target.description.value="",e.target.category.value="",e.target.price.value=""},className:"menu-manager",children:[Object(a.jsx)("input",{type:"text",name:"name",placeholder:"Food Name"}),Object(a.jsx)("textarea",{type:"text",name:"description",placeholder:"Food Description"}),Object(a.jsxs)("div",{className:"menu-manager-radio",children:[Object(a.jsxs)("div",{className:"menu-radio",children:[Object(a.jsx)("input",{type:"radio",name:"category",value:"coffee"}),Object(a.jsx)("label",{children:"Coffee"})]}),Object(a.jsxs)("div",{className:"menu-radio",children:[Object(a.jsx)("input",{type:"radio",name:"category",value:"food"}),Object(a.jsx)("label",{children:"Food"})]}),Object(a.jsxs)("div",{className:"menu-radio",children:[Object(a.jsx)("input",{type:"radio",name:"category",value:"dessert"}),Object(a.jsx)("label",{children:"Dessert"})]})]}),Object(a.jsx)("input",{type:"text",name:"price",placeholder:"Food Price"}),Object(a.jsx)("button",{className:"btn btn-primary",type:"submit",children:"CREATE NEW FOOD"})]})})]})},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BOOK_TIME":return t.data;default:return e}},at=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ORDER_FOOD":return e.concat(t.data);case"DELETE_FOOD":var n=e.filter((function(e){return e.item!==t.data.item}));return n;default:return e}},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DELIVER_ID":return t.data;default:return e}},it=Object(h.a)((function(e,t){var n=t.headers,r=localStorage.getItem("token");return{headers:Object(c.a)(Object(c.a)({},n),{},{authorization:r?"bearer ".concat(r):null})}})),ot=new u.HttpLink({uri:"https://restaurant.daisywebdev.com/graphql"}),lt=new b.a({uri:"wss://restaurant.daisywebdev.com/graphql-ws",options:{reconnect:!0}}),dt=Object(u.split)((function(e){var t=e.query,n=Object(j.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),lt,it.concat(ot)),ut=new u.ApolloClient({cache:new u.InMemoryCache,link:dt}),jt=Object(O.b)({books:ct,orders:at,deliverid:st}),bt=Object(O.c)(jt),Ot=Object(m.a)("pk_test_jfeD0SXgvoZ0qfB3nizgQGW500xwK6q5lo"),pt=function(){var e=Object(s.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(!1),o=Object(r.a)(i,2),u=o[0],j=o[1],b=Object(s.useState)(null),O=Object(r.a)(b,2),p=O[0],h=O[1],m=Object(s.useState)(null),x=Object(r.a)(m,2),g=x[0],f=x[1],y=Object(s.useState)(localStorage.getItem("username")),S=Object(r.a)(y,2),N=S[0],$=S[1],D=Object(s.useState)(localStorage.getItem("token")),w=Object(r.a)(D,2),k=w[0],C=w[1],q=Object(s.useState)(localStorage.getItem("userID")),I=Object(r.a)(q,2),M=I[0],F=I[1],R=Object(s.useState)(localStorage.getItem("role")),P=Object(r.a)(R,2),A=P[0],U=P[1],T=Object(s.useState)(localStorage.getItem("email")),L=Object(r.a)(T,2),B=L[0],z=L[1],K=function(e){h(e),setTimeout((function(){h(null)}),1e4)},Q=function(e){f(e),setTimeout((function(){f(null)}),1e4)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(l.a,{children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(d.b,{exact:!0,path:"/manager/menu",children:Object(a.jsx)(rt,{})}),Object(a.jsx)(d.b,{exact:!0,path:"/manager/reservation",children:Object(a.jsx)(Ze,{})}),Object(a.jsx)(d.b,{exact:!0,path:"/manager/deliver",children:Object(a.jsx)(Be,{})}),Object(a.jsx)(d.b,{exact:!0,path:"/manager",children:k?Object(a.jsx)(_,{setToken:C,setRole:U,setUserID:F,setUsername:$}):Object(a.jsx)(d.a,{to:"/"})}),Object(a.jsx)(d.b,{exact:!0,path:"/courtier",children:k?Object(a.jsx)(H,{setToken:C,setRole:U,setUserID:F,setUsername:$}):Object(a.jsx)(d.a,{to:"/"})}),Object(a.jsx)(d.b,{exact:!0,path:"/register",children:u?Object(a.jsx)(d.a,{to:"/login"}):Object(a.jsx)(Se,{setRegister:j,setError:K,setSuccess:Q,errorMessage:p,successMessage:g})}),Object(a.jsx)(d.b,{exact:!0,path:"/logout",children:Object(a.jsx)(d.a,{to:"/"})}),Object(a.jsx)(d.b,{exact:!0,path:"/login",children:k?Object(a.jsx)(d.a,{to:"/"}):Object(a.jsx)(ge,{setToken:C,setUsername:$,setUserID:F,setRole:U,setEmail:z,setReserve:c,setError:K,setSuccess:Q,errorMessage:p,successMessage:g})}),Object(a.jsx)(d.b,{exact:!0,path:"/reservation/signup",children:Object(a.jsx)(re,{setReserve:c,setError:K,setSuccess:Q,errorMessage:p,successMessage:g})}),Object(a.jsx)(d.b,{exact:!0,path:"/reservation",children:n?Object(a.jsx)(d.a,{to:"/reservation/signup"}):Object(a.jsx)(V,{setReserve:c,userID:M,email:B,setError:K,setSuccess:Q,errorMessage:p,successMessage:g})}),Object(a.jsx)(d.b,{exact:!0,path:"/delivering",children:Object(a.jsx)(Ee,{setError:K,setSuccess:Q,errorMessage:p,successMessage:g})}),Object(a.jsx)(d.b,{exact:!0,path:"/checkout",children:Object(a.jsx)(ke,{userID:M})}),Object(a.jsx)(d.b,{exact:!0,path:"/deliver/signup",children:Object(a.jsx)(me,{})}),Object(a.jsx)(d.b,{exact:!0,path:"/deliver",children:Object(a.jsx)(je,{userID:M})}),Object(a.jsxs)(d.b,{exact:!0,path:"/",children:["manager"===A&&Object(a.jsx)(d.a,{to:"/manager"}),"courtier"===A&&Object(a.jsx)(d.a,{to:"/courtier"}),Object(a.jsx)(E,{token:k,userID:M,username:N,setToken:C,setUsername:$,setUserID:F,setRole:U})]})]})}),Object(a.jsx)(v,{})]})};o.a.render(Object(a.jsx)(u.ApolloProvider,{client:ut,children:Object(a.jsx)(p.a,{store:bt,children:Object(a.jsx)(x.Elements,{stripe:Ot,children:Object(a.jsx)(pt,{})})})}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.266ce315.chunk.js.map